<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Componente: Blog New &mdash; documentación de Proyecto Angular - Práctica Profesional 2021-2 AIATIC - 0.1</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Componente: Blog Footer" href="blogFoteerComponent.html" />
    <link rel="prev" title="Componente: Blog Login" href="blogLoginComponent.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logotipo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../backend.html">Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontend.html">Frontend</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="wordpress.html">Implementación de Wordpress</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wordpress.html#primer-paso">Primer Paso</a></li>
<li class="toctree-l2"><a class="reference internal" href="wordpress.html#segundo-paso">Segundo Paso</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="wordpress.html#tercer-paso">Tercer Paso</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="postInterface.html">Interface: Post</a></li>
<li class="toctree-l3"><a class="reference internal" href="categoryInterface.html">Interface: WP_Category</a></li>
<li class="toctree-l3"><a class="reference internal" href="postService.html">Servicio: Blog</a></li>
<li class="toctree-l3"><a class="reference internal" href="authService.html">Servicio: Autenticación</a></li>
<li class="toctree-l3"><a class="reference internal" href="guardService.html">Servicio: BlogGuard</a></li>
<li class="toctree-l3"><a class="reference internal" href="blogComponent.html">Componente: Blog</a></li>
<li class="toctree-l3"><a class="reference internal" href="blogDetailComponent.html">Componente: Blog Detail</a></li>
<li class="toctree-l3"><a class="reference internal" href="blogDeleteComponent.html">Componente: Blog Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="blogEditComponent.html">Componente: Blog Edit</a></li>
<li class="toctree-l3"><a class="reference internal" href="blogLoginComponent.html">Componente: Blog Login</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Componente: Blog New</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metodo-obtener-categorias">Método: Obtener Categorias</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metodo-crear-entrada">Método: Crear Entrada</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metodos-carga-de-imagen">Métodos Carga de imagen</a></li>
<li class="toctree-l4"><a class="reference internal" href="#codigo-fuente-completo">Código Fuente completo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blogFoteerComponent.html">Componente: Blog Footer</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Proyecto Angular - Práctica Profesional 2021-2 AIATIC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="wordpress.html">Implementación de Wordpress</a> &raquo;</li>
      <li>Componente: Blog New</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/wp/blogNewComponent.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="componente-blog-new">
<h1>Componente: Blog New<a class="headerlink" href="#componente-blog-new" title="Enlazar permanentemente con este título"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Este componente es sólo accesible cuando el usuario inicia sesion.</p>
</div>
<p>Este componente tiene como función permitir la creación de una nueva entrada
del blog mediante el método Crear Nueva Entrada previamente definido
en el Servicio Blog.</p>
<figure class="align-center">
<img alt="Vistazo al componente Blog New" src="../_images/BlogNewComponent.png" />
</figure>
<p>Una vez que el usuario ingrese cada uno de los campos de la entrada y
de clic en el botón (Crear), aparecerá un modal en la pantala para notificar que la creación
de la nueva entrada se ha realizado exitosamente. Posteriormente se refrescará el componente
Blog en el que podrá apreciar los cambios efectuados.</p>
<figure class="align-center">
<img alt="Vistazo al componente Blog al estar autenticado" src="../_images/BlogNewComponent1.png" />
</figure>
<ul class="simple">
<li><p>Se procede a realizar la creación del componente ‘Blog’ con el siguiente
comando:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ng</span> <span class="pre">generate</span> <span class="pre">component</span> <span class="pre">components/wordpress/blog</span></code></p>
<ul class="simple">
<li><p>Se procede a efectuar la importación de las diferentes dependencias,
servicios y tipos requeridos en el componente.
Así mismo, se define las variables, los parametros requeridos en el constructor
y se implementan los métodos requeridos en el inicializador de Angular tal
como se aprecia a continuación:</p></li>
</ul>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">ElementRef</span><span class="p">,</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">ViewChild</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/core&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span> <span class="p">{</span> <span class="nx">FormBuilder</span><span class="p">,</span> <span class="nx">FormControl</span><span class="p">,</span> <span class="nx">FormGroup</span><span class="p">,</span> <span class="nx">Validators</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/forms&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="k">import</span> <span class="p">{</span> <span class="nx">BlogService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;src/app/services/wordpress/blog.service&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="k">import</span> <span class="nx">Swal</span> <span class="kr">from</span> <span class="s1">&#39;sweetalert2&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="k">import</span> <span class="p">{</span> <span class="nx">ActivatedRoute</span><span class="p">,</span> <span class="nx">Router</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/router&#39;</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs&#39;</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kd">@Component</span><span class="p">({</span>
<span class="linenos"> 9</span>  <span class="nx">selector</span><span class="o">:</span> <span class="s1">&#39;app-blognew&#39;</span><span class="p">,</span>
<span class="linenos">10</span>  <span class="nx">templateUrl</span><span class="o">:</span> <span class="s1">&#39;./blognew.component.html&#39;</span><span class="p">,</span>
<span class="linenos">11</span>  <span class="nx">styleUrls</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;./blognew.component.css&#39;</span><span class="p">]</span>
<span class="linenos">12</span><span class="p">})</span>
<span class="linenos">13</span><span class="k">export</span> <span class="kd">class</span> <span class="nx">BlognewComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
<span class="linenos">14</span>  <span class="c1">//Var selector de categorias</span>
<span class="linenos">15</span>  <span class="nx">categories</span>: <span class="kt">any</span><span class="o">=</span><span class="p">[];</span>
<span class="linenos">16</span>  <span class="nx">floatLabelControl</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FormControl</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span>  <span class="c1">//Var carga de imagen</span>
<span class="linenos">19</span>  <span class="nx">image</span>: <span class="kt">string</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos">20</span>
<span class="linenos">21</span>  <span class="nx">new_post</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">22</span>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">23</span>    <span class="nx">excerpt</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">24</span>    <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">25</span>    <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;publish&#39;</span><span class="p">,</span>
<span class="linenos">26</span>    <span class="p">}</span>
<span class="linenos">27</span>
<span class="linenos">28</span>  <span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">29</span>  <span class="nx">Msg</span>: <span class="kt">any</span><span class="p">;</span>
<span class="linenos">30</span>  <span class="nx">formSubmitted</span>: <span class="kt">boolean</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">31</span>  <span class="nx">isLoggedIn$</span>: <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">boolean</span><span class="o">&gt;</span><span class="p">;</span>
<span class="linenos">32</span>
<span class="linenos">33</span>  <span class="kr">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">fb</span>: <span class="kt">FormBuilder</span><span class="p">,</span>
<span class="linenos">34</span>     <span class="k">public</span> <span class="nx">blogService</span>: <span class="kt">BlogService</span><span class="p">,</span>
<span class="linenos">35</span>     <span class="k">private</span> <span class="nx">blog</span>:<span class="kt">BlogService</span><span class="p">,</span>
<span class="linenos">36</span>     <span class="k">private</span> <span class="nx">router</span>: <span class="kt">Router</span><span class="p">,</span>
<span class="linenos">37</span>     <span class="k">private</span> <span class="nx">route</span>:<span class="kt">ActivatedRoute</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="linenos">38</span>
<span class="linenos">39</span>     <span class="c1">//Formulario detalles post</span>
<span class="linenos">40</span>  <span class="nx">newForm</span>: <span class="kt">FormGroup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">group</span><span class="p">({</span>
<span class="linenos">41</span>    <span class="nx">title</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">compose</span><span class="p">([</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">])],</span>
<span class="linenos">42</span>    <span class="nx">excerpt</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span>  <span class="nx">Validators</span><span class="p">.</span><span class="nx">maxLength</span><span class="p">(</span><span class="mf">80</span><span class="p">),</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">minLength</span><span class="p">(</span><span class="mf">5</span><span class="p">)]],</span>
<span class="linenos">43</span>    <span class="nx">category</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">compose</span><span class="p">([</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">])],</span>
<span class="linenos">44</span>    <span class="nx">content</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">minLength</span><span class="p">(</span><span class="mf">5</span><span class="p">)]],</span>
<span class="linenos">45</span>    <span class="nx">featured_media</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="linenos">46</span><span class="p">});</span>
<span class="linenos">47</span>    <span class="c1">//Formulario para la carga de imagen</span>
<span class="linenos">48</span>
<span class="linenos">49</span>    <span class="nx">imgForm</span>: <span class="kt">FormGroup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">group</span><span class="p">({</span>
<span class="linenos">50</span>      <span class="nx">file</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">]],</span>
<span class="linenos">51</span>      <span class="nx">fileSource</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">]],</span>
<span class="linenos">52</span>  <span class="p">});</span>
<span class="linenos">53</span>
<span class="linenos">54</span>  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos">55</span>    <span class="k">this</span><span class="p">.</span><span class="nx">getAllCategories</span><span class="p">();</span>
<span class="linenos">56</span>  <span class="p">}</span>
</pre></div>
</div>
<section id="metodo-obtener-categorias">
<h2>Método: Obtener Categorias<a class="headerlink" href="#metodo-obtener-categorias" title="Enlazar permanentemente con este título"></a></h2>
<ul class="simple">
<li><p>Este método se encarga de obtener el listado de categorias existentes mediante
el método correspondiente definido en el Servicio Blog y hacerlos accesibles desde el
componente asignandolos a la variable: categories</p></li>
</ul>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  <span class="nx">getAllCategories</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos">2</span>    <span class="k">this</span><span class="p">.</span><span class="nx">blogService</span><span class="p">.</span><span class="nx">getCategories</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span>  <span class="p">{</span>
<span class="linenos">3</span>      <span class="k">this</span><span class="p">.</span><span class="nx">categories</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
<span class="linenos">4</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">categories</span><span class="p">);</span>
<span class="linenos">5</span>    <span class="p">});</span>
<span class="linenos">6</span>  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="metodo-crear-entrada">
<h2>Método: Crear Entrada<a class="headerlink" href="#metodo-crear-entrada" title="Enlazar permanentemente con este título"></a></h2>
<ul class="simple">
<li><p>Este método se encarga de obtener y tratar los datos diligenciados en el formualario
por el usuario para posteriormente enviarlos al método correspondiente definido en
el Servicio Blog.</p></li>
</ul>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  <span class="nx">createPost</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 2</span>    <span class="kd">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">newForm</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="linenos"> 3</span>    <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 6</span>      <span class="nx">title</span>: <span class="kt">val.title</span><span class="p">,</span>
<span class="linenos"> 7</span>      <span class="nx">excerpt</span>:<span class="kt">val.excerpt</span><span class="p">,</span>
<span class="linenos"> 8</span>      <span class="nx">content</span>: <span class="kt">val.content</span><span class="p">,</span>
<span class="linenos"> 9</span>      <span class="nx">categories</span>: <span class="kt">val.category</span><span class="p">,</span>
<span class="linenos">10</span>      <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;publish&#39;</span>
<span class="linenos">11</span>    <span class="p">};</span>
<span class="linenos">12</span>        <span class="k">this</span><span class="p">.</span><span class="nx">blog</span><span class="p">.</span><span class="nx">createpost</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos">13</span>        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span>
<span class="linenos">14</span>          <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">15</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">16</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">;</span>
<span class="linenos">17</span>            <span class="nx">Swal</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span> <span class="s1">&#39;Mensaje&#39;</span><span class="p">,</span> <span class="s1">&#39;El post ha sido creado exitosamente&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">);</span>
<span class="linenos">18</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos">19</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">20</span>              <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">&#39;..&#39;</span><span class="p">],</span> <span class="p">{</span> <span class="nx">relativeTo</span>: <span class="kt">this.route</span> <span class="p">});</span>
<span class="linenos">21</span>            <span class="p">})</span>
<span class="linenos">22</span>          <span class="p">},</span>
<span class="linenos">23</span>          <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">24</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">err</span>
<span class="linenos">25</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">26</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos">27</span>          <span class="p">}</span>
<span class="linenos">28</span>        <span class="p">);</span>
<span class="linenos">29</span>
<span class="linenos">30</span>    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="metodos-carga-de-imagen">
<h2>Métodos Carga de imagen<a class="headerlink" href="#metodos-carga-de-imagen" title="Enlazar permanentemente con este título"></a></h2>
<ul class="simple">
<li><p>Estos se encargan recibir y trata los datos relacionados con el formulario de carga de imagen,
así mismo, de alterar el evento al cargarse un archivo de imagen y convertir dicha imagen
a base64 para su posterior envio al servicio correspondiente en el <strong>Cuarto Método</strong> tal como
se aprecia a continuación:</p></li>
</ul>
<p>Primer método:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="nx">onFileChange</span><span class="p">(</span><span class="nx">event</span>:<span class="kt">any</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 2</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="p">{</span>
<span class="linenos"> 3</span>      <span class="kd">var</span> <span class="nx">filesAmount</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="linenos"> 4</span>      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">filesAmount</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos"> 5</span>              <span class="kd">var</span> <span class="nx">reader</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FileReader</span><span class="p">();</span>
<span class="linenos"> 6</span>              <span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span>:<span class="kt">any</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos"> 7</span>                <span class="c1">// Push Base64 string</span>
<span class="linenos"> 8</span>                <span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span> 
<span class="linenos"> 9</span>                <span class="k">this</span><span class="p">.</span><span class="nx">patchValues</span><span class="p">();</span>
<span class="linenos">10</span>              <span class="p">}</span>
<span class="linenos">11</span>              <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
<span class="linenos">12</span>      <span class="p">}</span>
<span class="linenos">13</span>  <span class="p">}</span>
<span class="linenos">14</span><span class="p">}</span>
</pre></div>
</div>
<p>Segundo método:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nx">patchValues</span><span class="p">(){</span>
<span class="linenos">2</span>  <span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">patchValue</span><span class="p">({</span>
<span class="linenos">3</span>     <span class="nx">fileSource</span>: <span class="kt">this.image</span>
<span class="linenos">4</span>  <span class="p">});</span>
<span class="linenos">5</span><span class="p">}</span>
</pre></div>
</div>
<p>Tercer método:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nx">removeImage</span><span class="p">(</span><span class="nx">url</span>:<span class="kt">any</span><span class="p">){</span>
<span class="linenos">2</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">,</span><span class="nx">url</span><span class="p">);</span>
<span class="linenos">3</span>  <span class="k">this</span><span class="p">.</span><span class="nx">image</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">img</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="nx">img</span> <span class="o">!=</span> <span class="nx">url</span><span class="p">));</span>
<span class="linenos">4</span>  <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">patchValue</span><span class="p">;</span>
<span class="linenos">5</span>  <span class="k">this</span><span class="p">.</span><span class="nx">patchValues</span><span class="p">();</span>
<span class="linenos">6</span><span class="p">}</span>
</pre></div>
</div>
<p>Cuarto método:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nx">submit</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>  <span class="kd">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FormData</span><span class="p">();</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">file</span><span class="p">);</span>
<span class="linenos"> 8</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="linenos"> 9</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;media_type&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">);</span>
<span class="linenos">10</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">fileSource</span><span class="p">);</span>
<span class="linenos">11</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;publish&#39;</span><span class="p">);</span>
<span class="linenos">12</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;comment_status&#39;</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">);</span>
<span class="linenos">13</span>
<span class="linenos">14</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="linenos">15</span>        <span class="k">this</span><span class="p">.</span><span class="nx">blog</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos">16</span>        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span>
<span class="linenos">17</span>          <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">18</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">;</span>
<span class="linenos">19</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="linenos">20</span>            <span class="nx">Swal</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span> <span class="s1">&#39;Mensaje&#39;</span><span class="p">,</span> <span class="s1">&#39;La imagen ha sido cargada exitosamente&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">);</span>
<span class="linenos">21</span>          <span class="p">},</span>
<span class="linenos">22</span>          <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">23</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">err</span>
<span class="linenos">24</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">Msg</span><span class="p">);</span>
<span class="linenos">25</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">26</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos">27</span>          <span class="p">}</span>
<span class="linenos">28</span>        <span class="p">);</span>
<span class="linenos">29</span><span class="p">}</span>
<span class="linenos">30</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="codigo-fuente-completo">
<h2>Código Fuente completo<a class="headerlink" href="#codigo-fuente-completo" title="Enlazar permanentemente con este título"></a></h2>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">ElementRef</span><span class="p">,</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">ViewChild</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/core&#39;</span><span class="p">;</span>
<span class="linenos">  2</span><span class="k">import</span> <span class="p">{</span> <span class="nx">FormBuilder</span><span class="p">,</span> <span class="nx">FormControl</span><span class="p">,</span> <span class="nx">FormGroup</span><span class="p">,</span> <span class="nx">Validators</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/forms&#39;</span><span class="p">;</span>
<span class="linenos">  3</span><span class="k">import</span> <span class="p">{</span> <span class="nx">BlogService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;src/app/services/wordpress/blog.service&#39;</span><span class="p">;</span>
<span class="linenos">  4</span><span class="k">import</span> <span class="nx">Swal</span> <span class="kr">from</span> <span class="s1">&#39;sweetalert2&#39;</span><span class="p">;</span>
<span class="linenos">  5</span><span class="k">import</span> <span class="p">{</span> <span class="nx">ActivatedRoute</span><span class="p">,</span> <span class="nx">Router</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/router&#39;</span><span class="p">;</span>
<span class="linenos">  6</span><span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs&#39;</span><span class="p">;</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="kd">@Component</span><span class="p">({</span>
<span class="linenos">  9</span>  <span class="nx">selector</span><span class="o">:</span> <span class="s1">&#39;app-blognew&#39;</span><span class="p">,</span>
<span class="linenos"> 10</span>  <span class="nx">templateUrl</span><span class="o">:</span> <span class="s1">&#39;./blognew.component.html&#39;</span><span class="p">,</span>
<span class="linenos"> 11</span>  <span class="nx">styleUrls</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;./blognew.component.css&#39;</span><span class="p">]</span>
<span class="linenos"> 12</span><span class="p">})</span>
<span class="linenos"> 13</span><span class="k">export</span> <span class="kd">class</span> <span class="nx">BlognewComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
<span class="linenos"> 14</span>  <span class="c1">//Var selector de categorias</span>
<span class="linenos"> 15</span>  <span class="nx">categories</span>: <span class="kt">any</span><span class="o">=</span><span class="p">[];</span>
<span class="linenos"> 16</span>  <span class="nx">floatLabelControl</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FormControl</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">);</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span>  <span class="c1">//Var carga de imagen</span>
<span class="linenos"> 19</span>  <span class="nx">image</span>: <span class="kt">string</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>  <span class="nx">new_post</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 22</span>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos"> 23</span>    <span class="nx">excerpt</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos"> 24</span>    <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos"> 25</span>    <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;publish&#39;</span><span class="p">,</span>
<span class="linenos"> 26</span>    <span class="p">}</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span>  <span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 29</span>  <span class="nx">Msg</span>: <span class="kt">any</span><span class="p">;</span>
<span class="linenos"> 30</span>  <span class="nx">formSubmitted</span>: <span class="kt">boolean</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 31</span>  <span class="nx">isLoggedIn$</span>: <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">boolean</span><span class="o">&gt;</span><span class="p">;</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>  <span class="kr">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">fb</span>: <span class="kt">FormBuilder</span><span class="p">,</span>
<span class="linenos"> 34</span>     <span class="k">public</span> <span class="nx">blogService</span>: <span class="kt">BlogService</span><span class="p">,</span>
<span class="linenos"> 35</span>     <span class="k">private</span> <span class="nx">blog</span>:<span class="kt">BlogService</span><span class="p">,</span>
<span class="linenos"> 36</span>     <span class="k">private</span> <span class="nx">router</span>: <span class="kt">Router</span><span class="p">,</span>
<span class="linenos"> 37</span>     <span class="k">private</span> <span class="nx">route</span>:<span class="kt">ActivatedRoute</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>     <span class="c1">//Formulario detalles post</span>
<span class="linenos"> 40</span>  <span class="nx">newForm</span>: <span class="kt">FormGroup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">group</span><span class="p">({</span>
<span class="linenos"> 41</span>    <span class="nx">title</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">compose</span><span class="p">([</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">])],</span>
<span class="linenos"> 42</span>    <span class="nx">excerpt</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span>  <span class="nx">Validators</span><span class="p">.</span><span class="nx">maxLength</span><span class="p">(</span><span class="mf">80</span><span class="p">),</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">minLength</span><span class="p">(</span><span class="mf">5</span><span class="p">)]],</span>
<span class="linenos"> 43</span>    <span class="nx">category</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">compose</span><span class="p">([</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">])],</span>
<span class="linenos"> 44</span>    <span class="nx">content</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span> <span class="nx">Validators</span><span class="p">.</span><span class="nx">minLength</span><span class="p">(</span><span class="mf">5</span><span class="p">)]],</span>
<span class="linenos"> 45</span>    <span class="nx">featured_media</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="linenos"> 46</span><span class="p">});</span>
<span class="linenos"> 47</span>    <span class="c1">//Formulario para la carga de imagen</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>    <span class="nx">imgForm</span>: <span class="kt">FormGroup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">group</span><span class="p">({</span>
<span class="linenos"> 50</span>      <span class="nx">file</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">]],</span>
<span class="linenos"> 51</span>      <span class="nx">fileSource</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Validators</span><span class="p">.</span><span class="nx">required</span><span class="p">]],</span>
<span class="linenos"> 52</span>  <span class="p">});</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 55</span>    <span class="k">this</span><span class="p">.</span><span class="nx">getAllCategories</span><span class="p">();</span>
<span class="linenos"> 56</span>  <span class="p">}</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span>  <span class="cm">/**Metodo que me devuelve las categorias existentes */</span>
<span class="linenos"> 61</span>  <span class="nx">getAllCategories</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 62</span>    <span class="k">this</span><span class="p">.</span><span class="nx">blogService</span><span class="p">.</span><span class="nx">getCategories</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span>  <span class="p">{</span>
<span class="linenos"> 63</span>      <span class="k">this</span><span class="p">.</span><span class="nx">categories</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
<span class="linenos"> 64</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">categories</span><span class="p">);</span>
<span class="linenos"> 65</span>    <span class="p">});</span>
<span class="linenos"> 66</span>  <span class="p">}</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span>  <span class="nx">createPost</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 70</span>    <span class="kd">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">newForm</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="linenos"> 71</span>    <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="linenos"> 72</span>
<span class="linenos"> 73</span>    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 74</span>      <span class="nx">title</span>: <span class="kt">val.title</span><span class="p">,</span>
<span class="linenos"> 75</span>      <span class="nx">excerpt</span>:<span class="kt">val.excerpt</span><span class="p">,</span>
<span class="linenos"> 76</span>      <span class="nx">content</span>: <span class="kt">val.content</span><span class="p">,</span>
<span class="linenos"> 77</span>      <span class="nx">categories</span>: <span class="kt">val.category</span><span class="p">,</span>
<span class="linenos"> 78</span>      <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;publish&#39;</span>
<span class="linenos"> 79</span>    <span class="p">};</span>
<span class="linenos"> 80</span>        <span class="k">this</span><span class="p">.</span><span class="nx">blog</span><span class="p">.</span><span class="nx">createpost</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos"> 81</span>        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span>
<span class="linenos"> 82</span>          <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos"> 83</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 84</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">;</span>
<span class="linenos"> 85</span>            <span class="nx">Swal</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span> <span class="s1">&#39;Mensaje&#39;</span><span class="p">,</span> <span class="s1">&#39;El post ha sido creado exitosamente&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">);</span>
<span class="linenos"> 86</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos"> 87</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos"> 88</span>              <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">&#39;..&#39;</span><span class="p">],</span> <span class="p">{</span> <span class="nx">relativeTo</span>: <span class="kt">this.route</span> <span class="p">});</span>
<span class="linenos"> 89</span>            <span class="p">})</span>
<span class="linenos"> 90</span>          <span class="p">},</span>
<span class="linenos"> 91</span>          <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos"> 92</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">err</span>
<span class="linenos"> 93</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 94</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos"> 95</span>          <span class="p">}</span>
<span class="linenos"> 96</span>        <span class="p">);</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span>    <span class="p">}</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span> <span class="cm">/* Carga de img */</span>
<span class="linenos">101</span>
<span class="linenos">102</span> <span class="nx">onFileChange</span><span class="p">(</span><span class="nx">event</span>:<span class="kt">any</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">103</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="p">{</span>
<span class="linenos">104</span>      <span class="kd">var</span> <span class="nx">filesAmount</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="linenos">105</span>      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">filesAmount</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">106</span>              <span class="kd">var</span> <span class="nx">reader</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FileReader</span><span class="p">();</span>
<span class="linenos">107</span>              <span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span>:<span class="kt">any</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">108</span>                <span class="c1">// Push Base64 string</span>
<span class="linenos">109</span>                <span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span> 
<span class="linenos">110</span>                <span class="k">this</span><span class="p">.</span><span class="nx">patchValues</span><span class="p">();</span>
<span class="linenos">111</span>              <span class="p">}</span>
<span class="linenos">112</span>              <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
<span class="linenos">113</span>      <span class="p">}</span>
<span class="linenos">114</span>  <span class="p">}</span>
<span class="linenos">115</span><span class="p">}</span>
<span class="linenos">116</span>
<span class="linenos">117</span><span class="c1">// Enrutar valor de imagen</span>
<span class="linenos">118</span><span class="nx">patchValues</span><span class="p">(){</span>
<span class="linenos">119</span>  <span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">patchValue</span><span class="p">({</span>
<span class="linenos">120</span>     <span class="nx">fileSource</span>: <span class="kt">this.image</span>
<span class="linenos">121</span>  <span class="p">});</span>
<span class="linenos">122</span><span class="p">}</span>
<span class="linenos">123</span>
<span class="linenos">124</span><span class="c1">// Función para remover imagen</span>
<span class="linenos">125</span><span class="nx">removeImage</span><span class="p">(</span><span class="nx">url</span>:<span class="kt">any</span><span class="p">){</span>
<span class="linenos">126</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">,</span><span class="nx">url</span><span class="p">);</span>
<span class="linenos">127</span>  <span class="k">this</span><span class="p">.</span><span class="nx">image</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">img</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="nx">img</span> <span class="o">!=</span> <span class="nx">url</span><span class="p">));</span>
<span class="linenos">128</span>  <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">patchValue</span><span class="p">;</span>
<span class="linenos">129</span>  <span class="k">this</span><span class="p">.</span><span class="nx">patchValues</span><span class="p">();</span>
<span class="linenos">130</span><span class="p">}</span>
<span class="linenos">131</span>   
<span class="linenos">132</span>
<span class="linenos">133</span><span class="nx">submit</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos">134</span>
<span class="linenos">135</span>  <span class="kd">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">imgForm</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="linenos">136</span>
<span class="linenos">137</span>    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">FormData</span><span class="p">();</span>
<span class="linenos">138</span>
<span class="linenos">139</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">file</span><span class="p">);</span>
<span class="linenos">140</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="linenos">141</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;media_type&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">);</span>
<span class="linenos">142</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="nx">val</span><span class="p">.</span><span class="nx">fileSource</span><span class="p">);</span>
<span class="linenos">143</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;publish&#39;</span><span class="p">);</span>
<span class="linenos">144</span>    <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;comment_status&#39;</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">);</span>
<span class="linenos">145</span>
<span class="linenos">146</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="linenos">147</span>        <span class="k">this</span><span class="p">.</span><span class="nx">blog</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="linenos">148</span>        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span>
<span class="linenos">149</span>          <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">150</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">;</span>
<span class="linenos">151</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="linenos">152</span>            <span class="nx">Swal</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span> <span class="s1">&#39;Mensaje&#39;</span><span class="p">,</span> <span class="s1">&#39;La imagen ha sido cargada exitosamente&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">);</span>
<span class="linenos">153</span>          <span class="p">},</span>
<span class="linenos">154</span>          <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="linenos">155</span>            <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="nx">err</span>
<span class="linenos">156</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">Msg</span><span class="p">);</span>
<span class="linenos">157</span>            <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="linenos">158</span>            <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">Msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mf">2500</span><span class="p">);</span>
<span class="linenos">159</span>          <span class="p">}</span>
<span class="linenos">160</span>        <span class="p">);</span>
<span class="linenos">161</span><span class="p">}</span>
<span class="linenos">162</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="blogLoginComponent.html" class="btn btn-neutral float-left" title="Componente: Blog Login" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="blogFoteerComponent.html" class="btn btn-neutral float-right" title="Componente: Blog Footer" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2021, Daniel Pacheco.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>